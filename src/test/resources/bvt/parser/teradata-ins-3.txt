INSERT INTO APP_MRKTNG_W.CPR_NM_CAP_ROLLUP_WK1_TE_W
 SELECT
  A.CMC_NAME,
  A.CMC_ID,
  A.SRC_CMPGN_CODE,
  A.CMPGN_CNTRY_CD,
  A.SEGM_NAME,
  A.SEGMENT_NAME,
  A.CHNL_ID,
  'O' AS READ_TYPE_FLAG,
  SUM(COALESCE(GMB_CAPPED, 0)) SUM_GMB_CAPPED,
  SUM(COALESCE(GMB_SQR_CAPPED, 0)) SUM_GMB_SQR_CAPPED,
  STDDEV_POP(COALESCE(GMB_CAPPED, 0)) STDDEV_GMB_CAPPED,
  SUM(COALESCE(QUANTITY_CAPPED, 0)) SUM_QUANTITY_CAPPED,
  SUM(COALESCE(QUANTITY_SQR_CAPPED, 0)) SUM_QUANTITY_SQR_CAPPED,
  STDDEV_POP(COALESCE(QUANTITY_CAPPED, 0)) STDDEV_QUANTITY_CAPPED
 FROM   
    (
     SELECT
   A.CMC_NAME,
   A.CMC_ID,
   A.SRC_CMPGN_CODE,
   A.CMPGN_CNTRY_CD,
   A.CMC_NAME AS SEGM_NAME,
   'ALL' AS SEGMENT_NAME,
   A.CHNL_ID,
   A.CNTCT_ID,
   SUM(COALESCE(GMB_CAPPED, 0)) AS GMB_CAPPED,
   SUM(COALESCE(GMB_CAPPED**2, 0)) AS GMB_SQR_CAPPED,
   SUM(COALESCE(QUANTITY_CAPPED, 0)) AS QUANTITY_CAPPED,
   SUM(COALESCE(QUANTITY_CAPPED**2, 0)) AS QUANTITY_SQR_CAPPED
     FROM
   APP_MRKTNG_W.CPR_NM_CNTCT_CAP_WK1_TE_W A
     GROUP BY 1,2,3,4,5,6,7,8
     ) A
 GROUP BY 1,2,3,4,5,6,7,8
;